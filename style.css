// script.js
const bootLines = [
  "booting cyberevy://_system",
  "> Initializing terminal...",
  "> Establishing uplink...",
  "> Access granted [OK]",
  "> Loading interface ███████████████ 100%",
  "\nSystem ready. Press any key to enter..."
];

const bootTextEl = document.getElementById('boot-text');
const cursor = document.getElementById('cursor');
const beep = document.getElementById('beep');
const bootSound = document.getElementById('boot-sound');

let line = 0;
let char = 0;
let booting = true;

function typeLine() {
  if (line < bootLines.length) {
    if (char < bootLines[line].length) {
      bootTextEl.innerHTML += bootLines[line][char++];
      beep.currentTime = 0;
      beep.play();
      setTimeout(typeLine, 20);
    } else {
      bootTextEl.innerHTML += '\n';
      line++;
      char = 0;
      setTimeout(typeLine, 400);
    }
  } else {
    document.addEventListener('keydown', showMain, { once: true });
  }
}

function showMain() {
  document.getElementById('boot').style.display = 'none';
  const main = document.getElementById('main');
  main.classList.add('fade-in');
  bootSound.play();

  const titleEl = document.getElementById("title");
  titleEl.classList.add("glitch");

  typeDynamic("cyberevy", "title", 100, () => {
    typeDynamic("ethical hacker, I break systems for fun, legally!", "subtitle", 30);
  });

  // Set up terminal command handler
  const terminalInput = document.getElementById("terminal-input");
  terminalInput.addEventListener("keydown", function (e) {
    if (e.key === "Enter") {
      const cmd = terminalInput.value.trim().toLowerCase();
      switch (cmd) {
        case "about":
          window.location.href = "about.html";
          break;
        case "projects":
          window.location.href = "projects.html";
          break;
        case "contact":
          window.location.href = "contact.html";
          break;
        case "":
          break;
        default:
          alert("Command not found: " + cmd);
      }
      terminalInput.value = "";
    }
  });
}

function typeDynamic(text, targetId, speed, callback) {
  const el = document.getElementById(targetId);
  let i = 0;
  el.innerHTML = '';
  function type() {
    if (i < text.length) {
      el.innerHTML += text[i++];
      setTimeout(type, speed);
    } else if (callback) {
      callback();
    }
  }
  type();
}

typeLine();
